<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · OMEinsumContractionOrders.jl</title><meta name="title" content="Reference · OMEinsumContractionOrders.jl"/><meta property="og:title" content="Reference · OMEinsumContractionOrders.jl"/><meta property="twitter:title" content="Reference · OMEinsumContractionOrders.jl"/><meta name="description" content="Documentation for OMEinsumContractionOrders.jl."/><meta property="og:description" content="Documentation for OMEinsumContractionOrders.jl."/><meta property="twitter:description" content="Documentation for OMEinsumContractionOrders.jl."/><meta property="og:url" content="https://GiggleLiu.github.io/OMEinsumContractionOrders.jl/ref/"/><meta property="twitter:url" content="https://GiggleLiu.github.io/OMEinsumContractionOrders.jl/ref/"/><link rel="canonical" href="https://GiggleLiu.github.io/OMEinsumContractionOrders.jl/ref/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">OMEinsumContractionOrders.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/master/docs/src/ref.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><ul><li><a href="#OMEinsumContractionOrders.ExactTreewidth"><code>OMEinsumContractionOrders.ExactTreewidth</code></a></li><li><a href="#OMEinsumContractionOrders.GreedyMethod"><code>OMEinsumContractionOrders.GreedyMethod</code></a></li><li><a href="#OMEinsumContractionOrders.KaHyParBipartite"><code>OMEinsumContractionOrders.KaHyParBipartite</code></a></li><li><a href="#OMEinsumContractionOrders.MergeGreedy"><code>OMEinsumContractionOrders.MergeGreedy</code></a></li><li><a href="#OMEinsumContractionOrders.MergeVectors"><code>OMEinsumContractionOrders.MergeVectors</code></a></li><li><a href="#OMEinsumContractionOrders.SABipartite"><code>OMEinsumContractionOrders.SABipartite</code></a></li><li><a href="#OMEinsumContractionOrders.TreeSA"><code>OMEinsumContractionOrders.TreeSA</code></a></li><li><a href="#OMEinsumContractionOrders.Treewidth"><code>OMEinsumContractionOrders.Treewidth</code></a></li><li><a href="#OMEinsumContractionOrders.contraction_complexity-Tuple{OMEinsumContractionOrders.AbstractEinsum, Any}"><code>OMEinsumContractionOrders.contraction_complexity</code></a></li><li><a href="#OMEinsumContractionOrders.flop-Union{Tuple{VT}, Tuple{LT}, Tuple{OMEinsumContractionOrders.EinCode, Dict{LT, VT}}} where {LT, VT}"><code>OMEinsumContractionOrders.flop</code></a></li><li><a href="#OMEinsumContractionOrders.label_elimination_order-Tuple{OMEinsumContractionOrders.NestedEinsum}"><code>OMEinsumContractionOrders.label_elimination_order</code></a></li><li><a href="#OMEinsumContractionOrders.optimize_code"><code>OMEinsumContractionOrders.optimize_code</code></a></li><li><a href="#OMEinsumContractionOrders.optimize_greedy-Union{Tuple{T2}, Tuple{TT}, Tuple{TA}, Tuple{L}, Tuple{OMEinsumContractionOrders.EinCode{L}, Dict{L, T2}}} where {L, TA, TT, T2}"><code>OMEinsumContractionOrders.optimize_greedy</code></a></li><li><a href="#OMEinsumContractionOrders.optimize_kahypar-Tuple{OMEinsumContractionOrders.EinCode, Any}"><code>OMEinsumContractionOrders.optimize_kahypar</code></a></li><li><a href="#OMEinsumContractionOrders.optimize_kahypar_auto-Tuple{OMEinsumContractionOrders.EinCode, Any}"><code>OMEinsumContractionOrders.optimize_kahypar_auto</code></a></li><li><a href="#OMEinsumContractionOrders.optimize_sa-Tuple{OMEinsumContractionOrders.EinCode, Any}"><code>OMEinsumContractionOrders.optimize_sa</code></a></li><li><a href="#OMEinsumContractionOrders.optimize_tree-Tuple{OMEinsumContractionOrders.AbstractEinsum, Any}"><code>OMEinsumContractionOrders.optimize_tree</code></a></li><li><a href="#OMEinsumContractionOrders.optimize_treewidth-Union{Tuple{EL}, Tuple{GM}, Tuple{Treewidth{EL, GM}, OMEinsumContractionOrders.AbstractEinsum, Dict}} where {GM, EL}"><code>OMEinsumContractionOrders.optimize_treewidth</code></a></li><li><a href="#OMEinsumContractionOrders.peak_memory-Tuple{OMEinsumContractionOrders.NestedEinsum, Dict}"><code>OMEinsumContractionOrders.peak_memory</code></a></li><li><a href="#OMEinsumContractionOrders.tree_greedy-Union{Tuple{ET}, Tuple{TT}, Tuple{TA}, Tuple{OMEinsumContractionOrders.IncidenceList{Int64, ET}, Any}} where {TA, TT, ET}"><code>OMEinsumContractionOrders.tree_greedy</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.ExactTreewidth" href="#OMEinsumContractionOrders.ExactTreewidth"><code>OMEinsumContractionOrders.ExactTreewidth</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">const ExactTreewidth{GM} = Treewidth{RuleReduction{BT}, GM}
ExactTreewidth(; greedy_config = GreedyMethod(nrepeat=1)) = Treewidth(; greedy_config)</code></pre><p><code>ExactTreewidth</code> is a specialization of <code>Treewidth</code> for the <code>RuleReduction</code> algorithm with the <code>BT</code> elimination algorithm. The <code>BT</code> algorithm is an exact solver for the treewidth problem that implemented in <a href="https://github.com/ArrogantGao/TreeWidthSolver.jl"><code>TreeWidthSolver.jl</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/treewidth.jl#L63-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.GreedyMethod" href="#OMEinsumContractionOrders.GreedyMethod"><code>OMEinsumContractionOrders.GreedyMethod</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GreedyMethod{MT}
GreedyMethod(; α = 0.0, temperature = 0.0, nrepeat=1)</code></pre><p>The fast but poor greedy optimizer. Input arguments are</p><pre><code class="nohighlight hljs">* `α` is the parameter for the loss function, for pairwise interaction, L = size(out) - α * (size(in1) + size(in2))
* `temperature` is the parameter for sampling, if it is zero, the minimum loss is selected; for non-zero, the loss is selected by the Boltzmann distribution, given by p ~ exp(-loss/temperature).
* `nrepeat` is the number of repeatition, returns the best contraction order.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/greedy.jl#L287-L296">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.KaHyParBipartite" href="#OMEinsumContractionOrders.KaHyParBipartite"><code>OMEinsumContractionOrders.KaHyParBipartite</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">KaHyParBipartite{RT,IT,GM}
KaHyParBipartite(; sc_target, imbalances=collect(0.0:0.005:0.8),
    max_group_size=40, greedy_config=GreedyMethod())</code></pre><p>Optimize the einsum code contraction order using the KaHyPar + Greedy approach. This program first recursively cuts the tensors into several groups using KaHyPar, with maximum group size specifed by <code>max_group_size</code> and maximum space complexity specified by <code>sc_target</code>, Then finds the contraction order inside each group with the greedy search algorithm. Other arguments are</p><ul><li><code>sc_target</code> is the target space complexity, defined as <code>log2(number of elements in the largest tensor)</code>,</li><li><code>imbalances</code> is a KaHyPar parameter that controls the group sizes in hierarchical bipartition,</li><li><code>max_group_size</code> is the maximum size that allowed to used greedy search,</li><li><code>greedy_config</code> is a greedy optimizer.</li></ul><p><strong>References</strong></p><ul><li><a href="https://arxiv.org/abs/2002.01935">Hyper-optimized tensor network contraction</a></li><li><a href="https://arxiv.org/abs/2103.03074">Simulating the Sycamore quantum supremacy circuits</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/kahypar.jl#L1-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.MergeGreedy" href="#OMEinsumContractionOrders.MergeGreedy"><code>OMEinsumContractionOrders.MergeGreedy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MergeGreedy &lt;: CodeSimplifier
MergeGreedy(; threshhold=-1e-12)</code></pre><p>Contraction code simplifier (in order to reduce the time of calling optimizers) that merges tensors greedily if the space complexity of merged tensors is reduced (difference smaller than the <code>threshhold</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/Core.jl#L160-L166">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.MergeVectors" href="#OMEinsumContractionOrders.MergeVectors"><code>OMEinsumContractionOrders.MergeVectors</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MergeVectors &lt;: CodeSimplifier
MergeVectors()</code></pre><p>Contraction code simplifier (in order to reduce the time of calling optimizers) that merges vectors to closest tensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/Core.jl#L171-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.SABipartite" href="#OMEinsumContractionOrders.SABipartite"><code>OMEinsumContractionOrders.SABipartite</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SABipartite{RT,BT}
SABipartite(; sc_target=25, ntrials=50, βs=0.1:0.2:15.0, niters=1000
    max_group_size=40, greedy_config=GreedyMethod(), initializer=:random)</code></pre><p>Optimize the einsum code contraction order using the Simulated Annealing bipartition + Greedy approach. This program first recursively cuts the tensors into several groups using simulated annealing, with maximum group size specifed by <code>max_group_size</code> and maximum space complexity specified by <code>sc_target</code>, Then finds the contraction order inside each group with the greedy search algorithm. Other arguments are</p><ul><li><code>size_dict</code>, a dictionary that specifies leg dimensions,</li><li><code>sc_target</code> is the target space complexity, defined as <code>log2(number of elements in the largest tensor)</code>,</li><li><code>max_group_size</code> is the maximum size that allowed to used greedy search,</li><li><code>βs</code> is a list of inverse temperature <code>1/T</code>,</li><li><code>niters</code> is the number of iteration in each temperature,</li><li><code>ntrials</code> is the number of repetition (with different random seeds),</li><li><code>sub_optimizer</code>, the optimizer for the bipartited sub graphs, one can choose <code>GreedyMethod()</code> or <code>TreeSA()</code>,</li><li><code>initializer</code>, the partition configuration initializer, one can choose <code>:random</code> or <code>:greedy</code> (slow but better).</li></ul><p><strong>References</strong></p><ul><li><a href="https://arxiv.org/abs/2002.01935">Hyper-optimized tensor network contraction</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/sa.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.TreeSA" href="#OMEinsumContractionOrders.TreeSA"><code>OMEinsumContractionOrders.TreeSA</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TreeSA{RT,IT,GM}
TreeSA(; sc_target=20, βs=collect(0.01:0.05:15), ntrials=10, niters=50,
    sc_weight=1.0, rw_weight=0.2, initializer=:greedy, greedy_config=GreedyMethod(; nrepeat=1))</code></pre><p>Optimize the einsum contraction pattern using the simulated annealing on tensor expression tree.</p><ul><li><code>sc_target</code> is the target space complexity,</li><li><code>ntrials</code>, <code>βs</code> and <code>niters</code> are annealing parameters, doing <code>ntrials</code> indepedent annealings, each has inverse tempteratures specified by <code>βs</code>, in each temperature, do <code>niters</code> updates of the tree.</li><li><code>sc_weight</code> is the relative importance factor of space complexity in the loss compared with the time complexity.</li><li><code>rw_weight</code> is the relative importance factor of memory read and write in the loss compared with the time complexity.</li><li><code>initializer</code> specifies how to determine the initial configuration, it can be <code>:greedy</code> or <code>:random</code>. If it is using <code>:greedy</code> method to generate the initial configuration, it also uses two extra arguments <code>greedy_method</code> and <code>greedy_nrepeat</code>.</li><li><code>nslices</code> is the number of sliced legs, default is 0.</li><li><code>fixed_slices</code> is a vector of sliced legs, default is <code>[]</code>.</li></ul><p><strong>References</strong></p><ul><li><a href="https://arxiv.org/abs/2108.05665">Recursive Multi-Tensor Contraction for XEB Verification of Quantum Circuits</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/treesa.jl#L146-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.Treewidth" href="#OMEinsumContractionOrders.Treewidth"><code>OMEinsumContractionOrders.Treewidth</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Treewidth{EL &lt;: EliminationAlgorithm, GM} &lt;: CodeOptimizer
Treewidth(; alg::EL = RuleReduction(BT()), greedy_config::GM = GreedyMethod(nrepeat=1))</code></pre><p>Tree width based solver. The solvers are implemented in <a href="https://algebraicjulia.github.io/CliqueTrees.jl/stable/">CliqueTrees.jl</a> and <a href="https://github.com/ArrogantGao/TreeWidthSolver.jl">TreeWidthSolver.jl</a>. They include:</p><table><tr><th style="text-align: left">Algorithm</th><th style="text-align: left">Description</th><th style="text-align: left">Time Complexity</th><th style="text-align: left">Space Complexity</th></tr><tr><td style="text-align: left"><code>BFS</code></td><td style="text-align: left">breadth-first search</td><td style="text-align: left">O(m + n)</td><td style="text-align: left">O(n)</td></tr><tr><td style="text-align: left"><code>MCS</code></td><td style="text-align: left">maximum cardinality search</td><td style="text-align: left">O(m + n)</td><td style="text-align: left">O(n)</td></tr><tr><td style="text-align: left"><code>LexBFS</code></td><td style="text-align: left">lexicographic breadth-first search</td><td style="text-align: left">O(m + n)</td><td style="text-align: left">O(m + n)</td></tr><tr><td style="text-align: left"><code>RCMMD</code></td><td style="text-align: left">reverse Cuthill-Mckee (minimum degree)</td><td style="text-align: left">O(m + n)</td><td style="text-align: left">O(m + n)</td></tr><tr><td style="text-align: left"><code>RCMGL</code></td><td style="text-align: left">reverse Cuthill-Mckee (George-Liu)</td><td style="text-align: left">O(m + n)</td><td style="text-align: left">O(m + n)</td></tr><tr><td style="text-align: left"><code>MCSM</code></td><td style="text-align: left">maximum cardinality search (minimal)</td><td style="text-align: left">O(mn)</td><td style="text-align: left">O(n)</td></tr><tr><td style="text-align: left"><code>LexM</code></td><td style="text-align: left">lexicographic breadth-first search (minimal)</td><td style="text-align: left">O(mn)</td><td style="text-align: left">O(n)</td></tr><tr><td style="text-align: left"><code>AMF</code></td><td style="text-align: left">approximate minimum fill</td><td style="text-align: left">O(mn)</td><td style="text-align: left">O(m + n)</td></tr><tr><td style="text-align: left"><code>MF</code></td><td style="text-align: left">minimum fill</td><td style="text-align: left">O(mn²)</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>MMD</code></td><td style="text-align: left">multiple minimum degree</td><td style="text-align: left">O(mn²)</td><td style="text-align: left">O(m + n)</td></tr><tr><td style="text-align: left"><code>MinimalChordal</code></td><td style="text-align: left">MinimalChordal</td><td style="text-align: left">-</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>CompositeRotations</code></td><td style="text-align: left">elimination tree rotation</td><td style="text-align: left">O(m + n)</td><td style="text-align: left">O(m + n)</td></tr><tr><td style="text-align: left"><code>RuleReduction</code></td><td style="text-align: left">treewith-safe rule-based reduction</td><td style="text-align: left">-</td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>ComponentReduction</code></td><td style="text-align: left">connected component reduction</td><td style="text-align: left">-</td><td style="text-align: left">-</td></tr></table><p>Detailed descriptions is available in the <a href="https://algebraicjulia.github.io/CliqueTrees.jl/stable/api/#Elimination-Algorithms">CliqueTrees.jl</a>.</p><p><strong>Fields</strong></p><ul><li><code>alg::EL</code>: The algorithm to use for the treewidth calculation. Available elimination algorithms are listed above.</li><li><code>greedy_config::GM</code>: The configuration for the greedy method.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; optimizer = Treewidth();

julia&gt; eincode = OMEinsumContractionOrders.EinCode([[&#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;e&#39;, &#39;f&#39;], [&#39;e&#39;], [&#39;d&#39;, &#39;f&#39;]], [&#39;a&#39;])
ab, acd, bcef, e, df -&gt; a

julia&gt; size_dict = Dict([c=&gt;(1&lt;&lt;i) for (i,c) in enumerate([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;])]...)
Dict{Char, Int64} with 6 entries:
  &#39;f&#39; =&gt; 64
  &#39;a&#39; =&gt; 2
  &#39;c&#39; =&gt; 8
  &#39;d&#39; =&gt; 16
  &#39;e&#39; =&gt; 32
  &#39;b&#39; =&gt; 4

julia&gt; optcode = optimize_code(eincode, size_dict, optimizer)
ab, ab -&gt; a
├─ fac, bcf -&gt; ab
│  ├─ df, acd -&gt; fac
│  │  ├─ df
│  │  └─ acd
│  └─ e, bcef -&gt; bcf
│     ├─ e
│     └─ bcef
└─ ab</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/treewidth.jl#L1-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.contraction_complexity-Tuple{OMEinsumContractionOrders.AbstractEinsum, Any}" href="#OMEinsumContractionOrders.contraction_complexity-Tuple{OMEinsumContractionOrders.AbstractEinsum, Any}"><code>OMEinsumContractionOrders.contraction_complexity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">contraction_complexity(eincode, size_dict) -&gt; ContractionComplexity</code></pre><p>Returns the time, space and read-write complexity of the einsum contraction. The returned object contains 3 fields:</p><ul><li>time complexity <code>tc</code> defined as <code>log2(number of element-wise multiplications)</code>.</li><li>space complexity <code>sc</code> defined as <code>log2(size of the maximum intermediate tensor)</code>.</li><li>read-write complexity <code>rwc</code> defined as <code>log2(the number of read-write operations)</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/complexity.jl#L182-L190">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.flop-Union{Tuple{VT}, Tuple{LT}, Tuple{OMEinsumContractionOrders.EinCode, Dict{LT, VT}}} where {LT, VT}" href="#OMEinsumContractionOrders.flop-Union{Tuple{VT}, Tuple{LT}, Tuple{OMEinsumContractionOrders.EinCode, Dict{LT, VT}}} where {LT, VT}"><code>OMEinsumContractionOrders.flop</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flop(eincode, size_dict) -&gt; Int</code></pre><p>Returns the number of iterations, which is different with the true floating point operations (FLOP) by a factor of 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/complexity.jl#L111-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.label_elimination_order-Tuple{OMEinsumContractionOrders.NestedEinsum}" href="#OMEinsumContractionOrders.label_elimination_order-Tuple{OMEinsumContractionOrders.NestedEinsum}"><code>OMEinsumContractionOrders.label_elimination_order</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">label_elimination_order(code) -&gt; Vector</code></pre><p>Returns a vector of labels sorted by the order they are eliminated in the contraction tree. The contraction tree is specified by <code>code</code>, which e.g. can be a <code>NestedEinsum</code> instance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/complexity.jl#L150-L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.optimize_code" href="#OMEinsumContractionOrders.optimize_code"><code>OMEinsumContractionOrders.optimize_code</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimize_code(eincode, size_dict, optimizer = GreedyMethod(), simplifier=nothing, permute=true) -&gt; optimized_eincode</code></pre><p>Optimize the einsum contraction code and reduce the time/space complexity of tensor network contraction. Returns a <code>NestedEinsum</code> instance. Input arguments are</p><ul><li><code>eincode</code> is an einsum contraction code instance, one of <code>DynamicEinCode</code>, <code>StaticEinCode</code> or <code>NestedEinsum</code>.</li><li><code>size</code> is a dictionary of &quot;edge label=&gt;edge size&quot; that contains the size information, one can use <code>uniformsize(eincode, 2)</code> to create a uniform size.</li><li><code>optimizer</code> is a <code>CodeOptimizer</code> instance, should be one of <code>GreedyMethod</code>, <code>Treewidth</code>, <code>KaHyParBipartite</code>, <code>SABipartite</code> or <code>TreeSA</code>. Check their docstrings for details.</li><li><code>simplifier</code> is one of <code>MergeVectors</code> or <code>MergeGreedy</code>.</li><li>optimize the permutation if <code>permute</code> is true.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using OMEinsum

julia&gt; code = ein&quot;ij, jk, kl, il-&gt;&quot;
ij, jk, kl, il -&gt; 

julia&gt; optimize_code(code, uniformsize(code, 2), TreeSA());</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/interfaces.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.optimize_greedy-Union{Tuple{T2}, Tuple{TT}, Tuple{TA}, Tuple{L}, Tuple{OMEinsumContractionOrders.EinCode{L}, Dict{L, T2}}} where {L, TA, TT, T2}" href="#OMEinsumContractionOrders.optimize_greedy-Union{Tuple{T2}, Tuple{TT}, Tuple{TA}, Tuple{L}, Tuple{OMEinsumContractionOrders.EinCode{L}, Dict{L, T2}}} where {L, TA, TT, T2}"><code>OMEinsumContractionOrders.optimize_greedy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimize_greedy(eincode, size_dict; α = 0.0, temperature = 0.0, nrepeat=1)</code></pre><p>Greedy optimizing the contraction order and return a <code>NestedEinsum</code> object. Check the docstring of <code>tree_greedy</code> for detailed explaination of other input arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/greedy.jl#L243-L248">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.optimize_kahypar-Tuple{OMEinsumContractionOrders.EinCode, Any}" href="#OMEinsumContractionOrders.optimize_kahypar-Tuple{OMEinsumContractionOrders.EinCode, Any}"><code>OMEinsumContractionOrders.optimize_kahypar</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimize_kahypar(code, size_dict; sc_target, max_group_size=40, imbalances=0.0:0.01:0.2, greedy_method=MinSpaceOut(), greedy_nrepeat=1)</code></pre><p>Optimize the einsum <code>code</code> contraction order using the KaHyPar + Greedy approach. <code>size_dict</code> is a dictionary that specifies leg dimensions.  Check the docstring of <code>KaHyParBipartite</code> for detailed explaination of other input arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/kahypar.jl#L138-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.optimize_kahypar_auto-Tuple{OMEinsumContractionOrders.EinCode, Any}" href="#OMEinsumContractionOrders.optimize_kahypar_auto-Tuple{OMEinsumContractionOrders.EinCode, Any}"><code>OMEinsumContractionOrders.optimize_kahypar_auto</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimize_kahypar_auto(code, size_dict; max_group_size=40, sub_optimizer = GreedyMethod())</code></pre><p>Find the optimal contraction order automatically by determining the <code>sc_target</code> with bisection. It can fail if the tree width of your graph is larger than <code>100</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/kahypar.jl#L173-L178">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.optimize_sa-Tuple{OMEinsumContractionOrders.EinCode, Any}" href="#OMEinsumContractionOrders.optimize_sa-Tuple{OMEinsumContractionOrders.EinCode, Any}"><code>OMEinsumContractionOrders.optimize_sa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimize_sa(code, size_dict; sc_target, max_group_size=40, βs=0.1:0.2:15.0, niters=1000, ntrials=50,
       sub_optimizer = GreedyMethod(), initializer=:random)</code></pre><p>Optimize the einsum <code>code</code> contraction order using the Simulated Annealing bipartition + Greedy approach. <code>size_dict</code> is a dictionary that specifies leg dimensions.  Check the docstring of <code>SABipartite</code> for detailed explaination of other input arguments.</p><p><strong>References</strong></p><ul><li><a href="https://arxiv.org/abs/2002.01935">Hyper-optimized tensor network contraction</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/sa.jl#L206-L216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.optimize_tree-Tuple{OMEinsumContractionOrders.AbstractEinsum, Any}" href="#OMEinsumContractionOrders.optimize_tree-Tuple{OMEinsumContractionOrders.AbstractEinsum, Any}"><code>OMEinsumContractionOrders.optimize_tree</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimize_tree(code, size_dict; sc_target=20, βs=0.1:0.1:10, ntrials=2, niters=100, sc_weight=1.0, rw_weight=0.2, initializer=:greedy, greedy_method=MinSpaceOut(), fixed_slices=[])</code></pre><p>Optimize the einsum contraction pattern specified by <code>code</code>, and edge sizes specified by <code>size_dict</code>. Check the docstring of <a href="#OMEinsumContractionOrders.TreeSA"><code>TreeSA</code></a> for detailed explaination of other input arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/treesa.jl#L179-L184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.optimize_treewidth-Union{Tuple{EL}, Tuple{GM}, Tuple{Treewidth{EL, GM}, OMEinsumContractionOrders.AbstractEinsum, Dict}} where {GM, EL}" href="#OMEinsumContractionOrders.optimize_treewidth-Union{Tuple{EL}, Tuple{GM}, Tuple{Treewidth{EL, GM}, OMEinsumContractionOrders.AbstractEinsum, Dict}} where {GM, EL}"><code>OMEinsumContractionOrders.optimize_treewidth</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimize_treewidth(optimizer, eincode, size_dict)</code></pre><p>Optimizing the contraction order via solve the exact tree width of the line graph corresponding to the eincode and return a <code>NestedEinsum</code> object. Check the docstring of <code>treewidth_method</code> for detailed explaination of other input arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/treewidth.jl#L176-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.peak_memory-Tuple{OMEinsumContractionOrders.NestedEinsum, Dict}" href="#OMEinsumContractionOrders.peak_memory-Tuple{OMEinsumContractionOrders.NestedEinsum, Dict}"><code>OMEinsumContractionOrders.peak_memory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">peak_memory(code, size_dict::Dict) -&gt; Int</code></pre><p>Estimate peak memory in number of elements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/complexity.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OMEinsumContractionOrders.tree_greedy-Union{Tuple{ET}, Tuple{TT}, Tuple{TA}, Tuple{OMEinsumContractionOrders.IncidenceList{Int64, ET}, Any}} where {TA, TT, ET}" href="#OMEinsumContractionOrders.tree_greedy-Union{Tuple{ET}, Tuple{TT}, Tuple{TA}, Tuple{OMEinsumContractionOrders.IncidenceList{Int64, ET}, Any}} where {TA, TT, ET}"><code>OMEinsumContractionOrders.tree_greedy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tree_greedy(incidence_list, log2_sizes; α = 0.0, temperature = 0.0, nrepeat=1)</code></pre><p>Compute greedy order, and the time and space complexities, the rows of the <code>incidence_list</code> are vertices and columns are edges. <code>log2_sizes</code> are defined on edges. <code>α</code> is the parameter for the loss function, for pairwise interaction, L = size(out) - α * (size(in1) + size(in2)) <code>temperature</code> is the parameter for sampling, if it is zero, the minimum loss is selected; for non-zero, the loss is selected by the Boltzmann distribution, given by p ~ exp(-loss/temperature).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TensorBFS/OMEinsumContractionOrders.jl/blob/8d7c827b53763c464f020ce6952d5202a07fac64/src/greedy.jl#L16-L23">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Monday 14 April 2025 23:53">Monday 14 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
